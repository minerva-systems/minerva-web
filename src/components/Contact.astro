---
const FORMSPREE_ENDPOINT = 'https://formspree.io/f/xqaqvdnn';
---

<section id="contact" class="contact">
  <div class="contact-container">
    <div class="contact-header">
      <h2 class="contact-title">Get In Touch</h2>
      <p class="contact-subtitle">Ready to build something great? Let's discuss your project.</p>
    </div>
    <div class="contact-form-wrapper">
      <form id="contact-form" class="contact-form" method="POST" action={FORMSPREE_ENDPOINT}>
        <div class="form-row">
          <div class="form-group">
            <label for="name" class="form-label">Name *</label>
            <input 
              type="text" 
              id="name"
              name="name"
              class="form-input"
              required
            />
          </div>
          <div class="form-group">
            <label for="email" class="form-label">Email *</label>
            <input 
              type="email" 
              id="email"
              name="email"
              class="form-input"
              required
            />
          </div>
        </div>
        
        <div class="form-group">
          <label for="company" class="form-label">Company</label>
          <input 
            type="text" 
            id="company"
            name="company"
            class="form-input"
          />
        </div>
        
        <div class="form-group">
          <label for="service" class="form-label">Service Interest</label>
          <select 
            id="service"
            name="service"
            class="form-select"
          >
            <option value="">Select a service</option>
            <option value="One-Time Website Build">One-Time Website Build</option>
            <option value="Website + Hosting + Monthly Consulting">Website + Hosting + Monthly Consulting</option>
            <option value="POW — Project-Oriented Work">POW — Project-Oriented Work</option>
            <option value="Other">Other</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="message" class="form-label">Message *</label>
          <textarea 
            id="message"
            name="message"
            rows="5"
            class="form-textarea"
            placeholder="Tell us about your project and how we can help..."
            required
          ></textarea>
        </div>
        
        <input type="hidden" name="_subject" value="New contact from Minerva Systems Website" />
        <input type="hidden" name="_format" value="plain" />
        
        <button 
          type="submit" 
          class="form-submit"
          id="submit-btn"
        >
          Send Message
        </button>
        
        <div id="form-message" class="form-message" style="display: none;"></div>
      </form>
    </div>
  </div>
</section>

<script>
  const form = document.getElementById('contact-form');
  const submitBtn = document.getElementById('submit-btn');
  const messageDiv = document.getElementById('form-message');

  form?.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const originalText = submitBtn?.textContent || 'Send Message';
    submitBtn?.setAttribute('disabled', 'true');
    submitBtn && (submitBtn.textContent = 'Sending...');
    messageDiv?.setAttribute('style', 'display: none;');

    const formData = new FormData(form);
    const data = Object.fromEntries(formData);

    try {
      const response = await fetch(form.action, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Accept': 'application/json'
        },
        body: JSON.stringify(data)
      });

      if (response.ok) {
        messageDiv?.setAttribute('class', 'form-message success');
        messageDiv && (messageDiv.textContent = 'Thank you for your message! We\'ll get back to you soon.');
        messageDiv?.setAttribute('style', 'display: block;');
        form.reset();
      } else {
        const errorData = await response.json();
        throw new Error(errorData.error || 'Form submission failed');
      }
    } catch (error) {
      console.error('Error:', error);
      messageDiv?.setAttribute('class', 'form-message error');
      messageDiv && (messageDiv.textContent = 'Sorry, there was an error submitting your message. Please try again.');
      messageDiv?.setAttribute('style', 'display: block;');
    } finally {
      submitBtn?.removeAttribute('disabled');
      submitBtn && (submitBtn.textContent = originalText);
    }
  });
</script>

<style>
  .contact {
    padding: 5rem 0;
    background: rgba(30, 41, 59, 0.3);
  }

  .contact-container {
    max-width: 1000px;
    margin: 0 auto;
    padding: 0 1rem;
  }

  .contact-header {
    text-align: center;
    margin-bottom: 3rem;
  }

  .contact-title {
    font-size: 2.5rem;
    font-weight: bold;
    margin-bottom: 1.5rem;
    color: #fbbf24;
  }

  .contact-subtitle {
    font-size: 1.25rem;
    color: #d1d5db;
  }

  .contact-form-wrapper {
    max-width: 600px;
    margin: 0 auto;
  }

  .contact-form {
    background: rgba(15, 23, 42, 0.7);
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    padding: 2.5rem;
    border-radius: 12px;
    border: 1px solid #334155;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
  }

  .form-row {
    display: grid;
    gap: 1.5rem;
    margin-bottom: 1.5rem;
  }

  .form-group {
    margin-bottom: 1.5rem;
  }

  .form-label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600;
    color: #fbbf24;
    font-size: 0.875rem;
  }

  .form-input,
  .form-select,
  .form-textarea {
    width: 100%;
    background: #1e293b;
    border: 2px solid #475569;
    border-radius: 8px;
    padding: 0.75rem 1rem;
    color: white;
    font-size: 1rem;
    transition: all 0.3s ease;
    box-sizing: border-box;
    font-family: inherit;
  }

  .form-input:focus,
  .form-select:focus,
  .form-textarea:focus {
    outline: none;
    border-color: #fbbf24;
    box-shadow: 0 0 0 3px rgba(251, 191, 36, 0.1);
  }

  .form-textarea {
    resize: vertical;
    min-height: 120px;
  }

  .form-submit {
    width: 100%;
    background: linear-gradient(45deg, #f59e0b, #eab308, #fbbf24, #f59e0b);
    background-size: 400% 400%;
    animation: gradientShift 3s ease infinite;
    color: #0f172a;
    padding: 1rem 2rem;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    font-size: 1.125rem;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .form-submit:hover:not(:disabled) {
    transform: translateY(-2px) scale(1.02);
  }

  .form-submit:disabled {
    opacity: 0.7;
    cursor: not-allowed;
  }

  .form-message {
    margin-top: 1rem;
    padding: 1rem;
    border-radius: 8px;
    text-align: center;
    font-weight: 500;
  }

  .form-message.success {
    background: rgba(34, 197, 94, 0.1);
    border: 1px solid rgba(34, 197, 94, 0.3);
    color: #4ade80;
  }

  .form-message.error {
    background: rgba(239, 68, 68, 0.1);
    border: 1px solid rgba(239, 68, 68, 0.3);
    color: #f87171;
  }

  @keyframes gradientShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  @media (min-width: 768px) {
    .form-row {
      grid-template-columns: 1fr 1fr;
    }
    
    .contact-title {
      font-size: 3rem;
    }
  }

  @media (min-width: 1024px) {
    .contact-title {
      font-size: 3.5rem;
    }
  }
</style>

